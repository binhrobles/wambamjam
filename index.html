<!DOCTYPE html>
<html>
  <head>
    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""/>
    <script src="http://unpkg.com/tone"></script>
    <script src="synth.js" type="text/javascript"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""></script>
    <link rel="stylesheet" href="styles.css" />
    <script>
      function play_synth(){
        //array of heights to test
        //const heights = [10.5, 18.0, 9.0, 3.3, 4.1, 7.5, 9.2, 62.5, 17.8, 10.6, 7.7, 57.5, 19.3, 7.2, 22.4, 50.0, 30.0, 45.0, 15.0, 20.9, 20.9, 16.5, 25.0, 10.0, 37.0, 117.1, 32.0, 25.0, 320.0, 45.0, 29.0, 161.0, 13.4, 46.3, 10.0, 10.0, 8.0, 90.0, 9.0, 28.5, 18.8, 18.8, 18.8, 18.8, 39.8, 28.0, 4.5, 4.5, 12.0, 12.0, 12.0, 5.0, 23.0, 20.0, 24.0, 24.0, 24.0, 13.5, 14.5, 13.5, 10.3, 13.0, 44.0, 83.0, 72.0, 76.0, 60.0, 88.0, 15.2, 40.0, 140.0, 12.9, 22.9, 65.1, 65.0, 13.4, 83.5, 7.0, 61.9, 5.6, 12.0, 54.0, 20.0, 44.6, 35.9, 29.0, 26.1, 12.7, 9.6, 8.9, 9.0, 6.6]
        const heights = [19.9,7.8,8.5,8.1,7.5,8.4,7.5,14.6,7.4,17.2,16.6,20.3,16.7,18.2,16.7,11.0,18.2,20.5]
        const notes = map_heights_to_notes(heights)
        const bpm = findBPM(heights)
        console.log(bpm)
        const synth = new Tone.Synth().toDestination();
        const seq = new Tone.Sequence((time, note) => {
            synth.triggerAttackRelease(note, 0.1, time);
            // subdivisions are given as subarrays
        }, notes).start(0);
        Tone.Transport.bpm.value = bpm
        Tone.Transport.start();
      }
    </script>
  </head>
  
  <body>
    <button onclick=play_synth()>Click me to play!</button>
    <div id="map"></div>
    <video id="webcam" autoplay playsinline></video>
    <button id="enableVision">enable vision</button>
    <script src="instrument.js"></script>
    <script type="module" src="vision.js"></script>
  </body>
</html>
